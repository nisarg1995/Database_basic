With movie_avg as (select mid, avg(rating) as avg1 from review group by mid), High_Ratings as (select distinct pid from actor_role ar, movie_avg ma where ar.mid=ma.mid and ma.avg1>=8), Low_Ratings as (select distinct pid from actor_role ar, movie_avg ma where ar.mid=ma.mid and ma.avg1<8), No_flop as ((select pid as pid1 from High_Ratings) minus (select * from Low_Ratings)), movie_cnt as (select pid, count(distinct mid) as cnt from actor_role, No_flop where pid = No_flop.pid1 group by pid) select name, cnt from movie_cnt mc1, person p1 where mc1.pid=p1.pid and ROWNUM <= 10 order by mc1.cnt desc, p1.name asc;